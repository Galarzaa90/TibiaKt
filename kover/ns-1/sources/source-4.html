


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > TibiaKtClient</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">com.galarzaa.tibiakt.client</a>
</div>

<h1>Coverage Summary for Class: TibiaKtClient (com.galarzaa.tibiakt.client)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
<th class="coverageStat 
">
  Instruction, %
</th>
</tr>
<tr>
  <td class="name">TibiaKtClient</td>
<td class="coverageStat">
  <span class="percent">
    8.9%
  </span>
  <span class="absValue">
    (5/56)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    5.4%
  </span>
  <span class="absValue">
    (7/130)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    9.4%
  </span>
  <span class="absValue">
    (25/265)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    5.9%
  </span>
  <span class="absValue">
    (160/2700)
  </span>
</td>
</tr>
  <tr>
    <td class="name">TibiaKtClient$1</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$client$1</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (6/6)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (35/35)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$client$1$1</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (13/13)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$client$1$2</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (12/12)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$client$1$3</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (10/10)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$client$1$4</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (1/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    93.8%
  </span>
  <span class="absValue">
    (15/16)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$Companion</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/18)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$Companion$logger$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchAjaxPage$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchAllPages$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/26)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchAuction$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchAuction$tibiaResponse$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/11)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchAuctionAdditionalPages$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchBazaar$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchBazaar$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchBosstableBosses$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchBosstableBosses$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchCharacter$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchCharacter$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchCMPostArchive$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchCMPostArchive$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchCreaturesSection$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchCreaturesSection$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchEventsSchedule$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchEventsSchedule$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchForumAnnouncement$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchForumAnnouncement$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/5)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchForumBoard$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchForumBoard$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchForumPost$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchForumPost$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/56)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchForumSection$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchForumSection$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchForumSection$3</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchForumSection$4</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchForumThread$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchForumThread$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchGuild$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchGuild$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchHighscoresPage$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchHighscoresPage$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchHigscores$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchHouse$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchHouse$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchHousesSection$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchHousesSection$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchKillStatistics$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchKillStatistics$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchLeaderboards$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchLeaderboards$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchNews$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchNews$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/5)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchRecentNews$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchRecentNews$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchWorld$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchWorld$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchWorldGuilds$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchWorldGuilds$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchWorldOverview$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$fetchWorldOverview$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$parse$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$parse$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/20)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$request$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$request$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/6)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/65)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$request$response$1$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/17)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$request$response$3</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$TimedResult</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/12)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TibiaKtClient$Timing</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/34)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    11.2%
  </span>
  <span class="absValue">
    (11/98)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    5.8%
  </span>
  <span class="absValue">
    (8/138)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    12.1%
  </span>
  <span class="absValue">
    (39/323)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    7.9%
  </span>
  <span class="absValue">
    (245/3115)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp; * Copyright © 2022 Allan Galarza
&nbsp; *
&nbsp; * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
&nbsp; * you may not use this file except in compliance with the License.
&nbsp; * You may obtain a copy of the License at
&nbsp; *
&nbsp; *     http://www.apache.org/licenses/LICENSE-2.0
&nbsp; *
&nbsp; * Unless required by applicable law or agreed to in writing, software
&nbsp; * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
&nbsp; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
&nbsp; * See the License for the specific language governing permissions and
&nbsp; * limitations under the License.
&nbsp; */
&nbsp;
&nbsp;package com.galarzaa.tibiakt.client
&nbsp;
&nbsp;import com.galarzaa.tibiakt.client.exceptions.ForbiddenException
&nbsp;import com.galarzaa.tibiakt.client.exceptions.NetworkException
&nbsp;import com.galarzaa.tibiakt.client.exceptions.SiteMaintenanceException
&nbsp;import com.galarzaa.tibiakt.core.builders.BazaarFiltersBuilder
&nbsp;import com.galarzaa.tibiakt.core.enums.AvailableForumSection
&nbsp;import com.galarzaa.tibiakt.core.enums.BazaarType
&nbsp;import com.galarzaa.tibiakt.core.enums.HighscoresBattlEyeType
&nbsp;import com.galarzaa.tibiakt.core.enums.HighscoresCategory
&nbsp;import com.galarzaa.tibiakt.core.enums.HighscoresProfession
&nbsp;import com.galarzaa.tibiakt.core.enums.HouseOrder
&nbsp;import com.galarzaa.tibiakt.core.enums.HouseStatus
&nbsp;import com.galarzaa.tibiakt.core.enums.HouseType
&nbsp;import com.galarzaa.tibiakt.core.enums.NewsCategory
&nbsp;import com.galarzaa.tibiakt.core.enums.NewsType
&nbsp;import com.galarzaa.tibiakt.core.enums.PvpType
&nbsp;import com.galarzaa.tibiakt.core.models.KillStatistics
&nbsp;import com.galarzaa.tibiakt.core.models.bazaar.AjaxPaginator
&nbsp;import com.galarzaa.tibiakt.core.models.bazaar.Auction
&nbsp;import com.galarzaa.tibiakt.core.models.bazaar.BazaarFilters
&nbsp;import com.galarzaa.tibiakt.core.models.bazaar.CharacterBazaar
&nbsp;import com.galarzaa.tibiakt.core.models.bazaar.ItemEntry
&nbsp;import com.galarzaa.tibiakt.core.models.bazaar.MountEntry
&nbsp;import com.galarzaa.tibiakt.core.models.bazaar.OutfitEntry
&nbsp;import com.galarzaa.tibiakt.core.models.character.Character
&nbsp;import com.galarzaa.tibiakt.core.models.creatures.BosstableBosses
&nbsp;import com.galarzaa.tibiakt.core.models.creatures.CreaturesSection
&nbsp;import com.galarzaa.tibiakt.core.models.forums.CMPostArchive
&nbsp;import com.galarzaa.tibiakt.core.models.forums.ForumAnnouncement
&nbsp;import com.galarzaa.tibiakt.core.models.forums.ForumBoard
&nbsp;import com.galarzaa.tibiakt.core.models.forums.ForumSection
&nbsp;import com.galarzaa.tibiakt.core.models.forums.ForumThread
&nbsp;import com.galarzaa.tibiakt.core.models.guild.Guild
&nbsp;import com.galarzaa.tibiakt.core.models.guild.GuildsSection
&nbsp;import com.galarzaa.tibiakt.core.models.highscores.Highscores
&nbsp;import com.galarzaa.tibiakt.core.models.highscores.HighscoresEntry
&nbsp;import com.galarzaa.tibiakt.core.models.house.House
&nbsp;import com.galarzaa.tibiakt.core.models.house.HousesSection
&nbsp;import com.galarzaa.tibiakt.core.models.leaderboards.Leaderboards
&nbsp;import com.galarzaa.tibiakt.core.models.news.EventsSchedule
&nbsp;import com.galarzaa.tibiakt.core.models.news.News
&nbsp;import com.galarzaa.tibiakt.core.models.news.NewsArchive
&nbsp;import com.galarzaa.tibiakt.core.models.world.World
&nbsp;import com.galarzaa.tibiakt.core.models.world.WorldOverview
&nbsp;import com.galarzaa.tibiakt.core.parsers.AuctionParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.BosstableBossesParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.CMPostArchiveParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.CharacterBazaarParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.CharacterParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.CreaturesSectionParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.EventsScheduleParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.ForumAnnouncementParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.ForumBoardParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.ForumSectionParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.ForumThreadParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.GuildParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.GuildsSectionParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.HighscoresParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.HouseParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.HousesSectionParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.KillStatisticsParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.LeaderboardsParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.NewsArchiveParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.NewsParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.WorldOverviewParser
&nbsp;import com.galarzaa.tibiakt.core.parsers.WorldParser
&nbsp;import com.galarzaa.tibiakt.core.utils.getAuctionUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getBazaarUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getBoostableBossesUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getCMPostArchiveUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getCharacterUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getCreaturesSectionUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getEventsScheduleUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getForumAnnouncementUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getForumBoardUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getForumPostUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getForumSectionUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getForumThreadUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getGuildUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getHighscoresUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getHouseUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getHousesSectionUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getKillStatisticsUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getLeaderboardUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getNewArchiveFormData
&nbsp;import com.galarzaa.tibiakt.core.utils.getNewsArchiveUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getNewsUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getWorldGuildsUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getWorldOverviewUrl
&nbsp;import com.galarzaa.tibiakt.core.utils.getWorldUrl
&nbsp;import io.ktor.client.HttpClient
&nbsp;import io.ktor.client.HttpClientConfig
&nbsp;import io.ktor.client.call.body
&nbsp;import io.ktor.client.engine.HttpClientEngine
&nbsp;import io.ktor.client.engine.cio.CIO
&nbsp;import io.ktor.client.plugins.Charsets
&nbsp;import io.ktor.client.plugins.HttpTimeout
&nbsp;import io.ktor.client.plugins.ResponseException
&nbsp;import io.ktor.client.plugins.UserAgent
&nbsp;import io.ktor.client.plugins.compression.ContentEncoding
&nbsp;import io.ktor.client.plugins.expectSuccess
&nbsp;import io.ktor.client.request.forms.submitForm
&nbsp;import io.ktor.client.request.get
&nbsp;import io.ktor.client.request.header
&nbsp;import io.ktor.client.request.headers
&nbsp;import io.ktor.client.statement.HttpResponse
&nbsp;import io.ktor.client.statement.request
&nbsp;import io.ktor.http.HttpMethod
&nbsp;import io.ktor.http.HttpStatusCode
&nbsp;import io.ktor.http.Parameters
&nbsp;import kotlinx.datetime.Clock
&nbsp;import kotlinx.datetime.Instant
&nbsp;import kotlinx.serialization.json.Json
&nbsp;import mu.KotlinLogging
&nbsp;import java.time.LocalDate
&nbsp;import java.time.YearMonth
&nbsp;import kotlin.system.measureTimeMillis
&nbsp;import kotlin.time.Duration.Companion.seconds
&nbsp;
<b class="fc">&nbsp;@Suppress(&quot;TooManyFunctions&quot;)</b>
&nbsp;/**
&nbsp; * A coroutine based client to fetch from Tibia.com.
&nbsp; *
&nbsp; * @param engine The ktor client engine to use, by default CIO is used.
&nbsp; * @param additionalConfig Additional configuration for the Ktor Client.
&nbsp; */
&nbsp;public open class TibiaKtClient constructor(
&nbsp;    engine: HttpClientEngine?,
<b class="fc">&nbsp;    private val userAgent: String? = null,</b>
<b class="fc">&nbsp;    private val additionalConfig: (HttpClientConfig&lt;*&gt;.() -&gt; Unit) = {},</b>
&nbsp;) {
&nbsp;
<b class="pc">&nbsp;    private val client = HttpClient(engine ?: CIO.create()) {</b>
<b class="fc">&nbsp;        install(HttpTimeout) {</b>
<b class="fc">&nbsp;            requestTimeoutMillis = HttpTimeout.INFINITE_TIMEOUT_MS</b>
<b class="fc">&nbsp;            connectTimeoutMillis = 30.seconds.inWholeMilliseconds</b>
&nbsp;        }
<b class="fc">&nbsp;        Charsets {</b>
<b class="fc">&nbsp;            register(Charsets.UTF_8)</b>
<b class="fc">&nbsp;            register(Charsets.ISO_8859_1)</b>
&nbsp;        }
<b class="fc">&nbsp;        followRedirects = false</b>
<b class="fc">&nbsp;        install(ContentEncoding) {</b>
<b class="fc">&nbsp;            gzip()</b>
<b class="fc">&nbsp;            deflate()</b>
&nbsp;        }
<b class="fc">&nbsp;        install(UserAgent) {</b>
<b class="pc">&nbsp;            agent = userAgent ?: &quot;TibiaKtClient/? ktor/? Kotlin/${KotlinVersion.CURRENT}&quot;</b>
&nbsp;        }
<b class="fc">&nbsp;        additionalConfig(this)</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Creates an instance of the client, using the default engine (CIO).
&nbsp;     *
&nbsp;     * @param userAgent The value that will be sent in the User-Agent header of every request.
&nbsp;     */
<b class="nc">&nbsp;    public constructor(userAgent: String? = null, additionalConfig: (HttpClientConfig&lt;*&gt;.() -&gt; Unit) = {}) : this(</b>
<b class="nc">&nbsp;        null, userAgent, additionalConfig</b>
&nbsp;    )
&nbsp;
&nbsp;    /**
&nbsp;     * Perform a request using the required headers.
&nbsp;     * @param method The HTTP method to use for the request.
&nbsp;     * @param url The URL to request.
&nbsp;     * @param data The form parameters to add.
&nbsp;     * @param headers Additional headers to add.
&nbsp;     */
<b class="fc">&nbsp;    public open suspend fun request(</b>
&nbsp;        method: HttpMethod,
&nbsp;        url: String,
<b class="fc">&nbsp;        data: List&lt;Pair&lt;String, Any&gt;&gt; = emptyList(),</b>
<b class="fc">&nbsp;        headers: List&lt;Pair&lt;String, Any&gt;&gt; = emptyList(),</b>
&nbsp;    ): HttpResponse {
<b class="fc">&nbsp;        val response: HttpResponse = try {</b>
<b class="fc">&nbsp;            when (method) {</b>
<b class="pc">&nbsp;                HttpMethod.Get -&gt; client.get(url) {</b>
<b class="fc">&nbsp;                    expectSuccess = true</b>
<b class="pc">&nbsp;                    if (headers.isNotEmpty()) {</b>
<b class="nc">&nbsp;                        headers { headers.forEach { header(it.first, it.second) } }</b>
&nbsp;                    }
<b class="fc">&nbsp;                }</b>
&nbsp;
<b class="nc">&nbsp;                HttpMethod.Post -&gt; client.submitForm(url, formParameters = Parameters.build {</b>
<b class="nc">&nbsp;                    data.forEach { append(it.first, it.second.toString()) }</b>
<b class="nc">&nbsp;                }, encodeInQuery = false) {</b>
&nbsp;
<b class="nc">&nbsp;                }</b>
&nbsp;
<b class="nc">&nbsp;                else -&gt; throw IllegalArgumentException(&quot;Unsupported method $method&quot;)</b>
&nbsp;            }
<b class="fc">&nbsp;        } catch (re: ResponseException) {</b>
<b class="pc">&nbsp;            if (re.response.status in listOf(</b>
<b class="fc">&nbsp;                    HttpStatusCode.MovedPermanently,</b>
<b class="fc">&nbsp;                    HttpStatusCode.Found,</b>
<b class="fc">&nbsp;                    HttpStatusCode.TemporaryRedirect,</b>
<b class="fc">&nbsp;                    HttpStatusCode.PermanentRedirect,</b>
<b class="fc">&nbsp;                    HttpStatusCode.SeeOther</b>
&nbsp;                )
&nbsp;            ) {
<b class="nc">&nbsp;                throw SiteMaintenanceException(&quot;Tibia.com is under maintenance.&quot;, re)</b>
&nbsp;            }
<b class="pc">&nbsp;            if (re.response.status == HttpStatusCode.Forbidden) {</b>
<b class="fc">&nbsp;                throw ForbiddenException(&quot;403 Forbidden: Might be getting rate-limited&quot;, re)</b>
&nbsp;            }
<b class="nc">&nbsp;            throw NetworkException(&quot;${re.response.status.value} ${re.response.status.description}&quot;, re)</b>
&nbsp;        }
<b class="nc">&nbsp;        logger.info {</b>
<b class="nc">&nbsp;            listOf(</b>
<b class="nc">&nbsp;                url,</b>
<b class="nc">&nbsp;                method.value.uppercase(),</b>
<b class="nc">&nbsp;                &quot;${response.status.value} ${response.status.description}&quot;,</b>
<b class="nc">&nbsp;                &quot;${response.fetchingTimeMillis}ms&quot;</b>
<b class="nc">&nbsp;            ).joinToString(&quot; | &quot;)</b>
&nbsp;        }
<b class="nc">&nbsp;        return response</b>
&nbsp;    }
&nbsp;
&nbsp;    // region News Section
&nbsp;
&nbsp;    /**
&nbsp;     * Fetch the news for a given interval.
&nbsp;     */
<b class="nc">&nbsp;    public open suspend fun fetchRecentNews(</b>
&nbsp;        startDate: LocalDate,
&nbsp;        endDate: LocalDate,
<b class="nc">&nbsp;        categories: Set&lt;NewsCategory&gt;? = null,</b>
<b class="nc">&nbsp;        types: Set&lt;NewsType&gt;? = null,</b>
&nbsp;    ): TibiaResponse&lt;NewsArchive&gt; {
<b class="nc">&nbsp;        val data = getNewArchiveFormData(startDate, endDate, categories, types)</b>
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Post, getNewsArchiveUrl(), data)</b>
<b class="nc">&nbsp;        return response.parse { NewsArchiveParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Fetch the news from today to the last provided days.
&nbsp;     */
<b class="nc">&nbsp;    public open suspend fun fetchRecentNews(</b>
<b class="nc">&nbsp;        days: Int = 30,</b>
<b class="nc">&nbsp;        categories: Set&lt;NewsCategory&gt;? = null,</b>
<b class="nc">&nbsp;        types: Set&lt;NewsType&gt;? = null,</b>
&nbsp;    ): TibiaResponse&lt;NewsArchive&gt; =
<b class="nc">&nbsp;        fetchRecentNews(LocalDate.now().minusDays(days.toLong()), LocalDate.now(), categories, types)</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Fetch a specific news article by its [newsId].
&nbsp;     */
<b class="nc">&nbsp;    public open suspend fun fetchNews(newsId: Int): TibiaResponse&lt;News?&gt; {</b>
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getNewsUrl(newsId))</b>
<b class="nc">&nbsp;        return response.parse { NewsParser.fromContent(it, newsId) }</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Fetch the events schedule for a specific year and month.
&nbsp;     */
<b class="nc">&nbsp;    public open suspend fun fetchEventsSchedule(yearMonth: YearMonth): TibiaResponse&lt;EventsSchedule&gt; {</b>
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getEventsScheduleUrl(yearMonth))</b>
<b class="nc">&nbsp;        return response.parse { EventsScheduleParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Fetch the events schedule for a specific year and month.
&nbsp;     */
&nbsp;    public open suspend fun fetchEventsSchedule(year: Int, month: Int): TibiaResponse&lt;EventsSchedule&gt; =
<b class="nc">&nbsp;        fetchEventsSchedule(YearMonth.of(year, month))</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Fetch the events schedule for the current month.
&nbsp;     */
<b class="nc">&nbsp;    public open suspend fun fetchEventsSchedule(): TibiaResponse&lt;EventsSchedule&gt; = fetchEventsSchedule(YearMonth.now())</b>
&nbsp;
&nbsp;    // endregion
&nbsp;
&nbsp;    // region Library Section
&nbsp;    /** Fetch the boosted boss of the day as well as the list of bosstable bosses from Tibia.com. */
<b class="nc">&nbsp;    public open suspend fun fetchBosstableBosses(): TibiaResponse&lt;BosstableBosses&gt; {</b>
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getBoostableBossesUrl())</b>
<b class="nc">&nbsp;        return response.parse { BosstableBossesParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
&nbsp;    /** Fetch the creatures section, containing the boosted creature. */
<b class="nc">&nbsp;    public open suspend fun fetchCreaturesSection(): TibiaResponse&lt;CreaturesSection&gt; {</b>
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getCreaturesSectionUrl())</b>
<b class="nc">&nbsp;        return response.parse { CreaturesSectionParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
&nbsp;    // endregion
&nbsp;
&nbsp;    // region Community Section
&nbsp;
&nbsp;    /**
&nbsp;     * Fetch a character.
&nbsp;     *
&nbsp;     * @param name The name of the character.
&nbsp;     */
<b class="fc">&nbsp;    public open suspend fun fetchCharacter(name: String): TibiaResponse&lt;Character?&gt; {</b>
<b class="pc">&nbsp;        val response = this.request(HttpMethod.Get, getCharacterUrl(name))</b>
<b class="nc">&nbsp;        return response.parse { CharacterParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Fetch the world overview, containing the list of worlds.
&nbsp;     */
<b class="nc">&nbsp;    public open suspend fun fetchWorldOverview(): TibiaResponse&lt;WorldOverview&gt; {</b>
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getWorldOverviewUrl())</b>
<b class="nc">&nbsp;        return response.parse { WorldOverviewParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
&nbsp;    /** Fetch a world&#39;s information. */
<b class="nc">&nbsp;    public open suspend fun fetchWorld(name: String): TibiaResponse&lt;World?&gt; {</b>
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getWorldUrl(name))</b>
<b class="nc">&nbsp;        return response.parse { WorldParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
&nbsp;    /** Fetch a guild by its [name]. */
<b class="nc">&nbsp;    public open suspend fun fetchGuild(name: String): TibiaResponse&lt;Guild?&gt; {</b>
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getGuildUrl(name))</b>
<b class="nc">&nbsp;        return response.parse { GuildParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
&nbsp;    /** Fetch active and in formation guilds in a [world].
&nbsp;     *
&nbsp;     * If the world does not exist, it will return null.
&nbsp;     */
<b class="nc">&nbsp;    public open suspend fun fetchWorldGuilds(world: String): TibiaResponse&lt;GuildsSection?&gt; {</b>
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getWorldGuildsUrl(world))</b>
<b class="nc">&nbsp;        return response.parse { GuildsSectionParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Fetch the kill statistics for a [world].
&nbsp;     */
<b class="nc">&nbsp;    public open suspend fun fetchKillStatistics(world: String): TibiaResponse&lt;KillStatistics?&gt; {</b>
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getKillStatisticsUrl(world))</b>
<b class="nc">&nbsp;        return response.parse { KillStatisticsParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Fetch a page of the highscores.
&nbsp;     *
&nbsp;     * @param world The world to get highscores from. If null, the highscores of all worlds are returned.
&nbsp;     * @param category The category to fetch.
&nbsp;     * @param vocation The vocation to filter by. By default all vocations will be returned
&nbsp;     * @param page The page number to fetch
&nbsp;     * @param battlEyeType The BattlEye type of the worlds to fetch. Only applies when [world] is null.
&nbsp;     * @param pvpTypes The PvP type of the worlds to fetch. Only applies when [world] is null.
&nbsp;     */
<b class="nc">&nbsp;    public open suspend fun fetchHighscoresPage(</b>
&nbsp;        world: String?,
&nbsp;        category: HighscoresCategory,
<b class="nc">&nbsp;        vocation: HighscoresProfession = HighscoresProfession.ALL,</b>
<b class="nc">&nbsp;        page: Int = 1,</b>
<b class="nc">&nbsp;        battlEyeType: HighscoresBattlEyeType = HighscoresBattlEyeType.ANY_WORLD,</b>
<b class="nc">&nbsp;        pvpTypes: Set&lt;PvpType&gt;? = null,</b>
&nbsp;    ): TibiaResponse&lt;Highscores?&gt; {
<b class="nc">&nbsp;        val response =</b>
<b class="nc">&nbsp;            this.request(HttpMethod.Get, getHighscoresUrl(world, category, vocation, page, battlEyeType, pvpTypes))</b>
<b class="nc">&nbsp;        return response.parse { HighscoresParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    public open suspend fun fetchHigscores(</b>
&nbsp;        world: String?,
&nbsp;        category: HighscoresCategory,
<b class="nc">&nbsp;        vocation: HighscoresProfession = HighscoresProfession.ALL,</b>
<b class="nc">&nbsp;        battlEyeType: HighscoresBattlEyeType = HighscoresBattlEyeType.ANY_WORLD,</b>
<b class="nc">&nbsp;        pvpTypes: Set&lt;PvpType&gt;? = null,</b>
&nbsp;    ): TibiaResponse&lt;Highscores?&gt; {
<b class="nc">&nbsp;        val now = Clock.System.now()</b>
<b class="nc">&nbsp;        var totalPages = 0</b>
<b class="nc">&nbsp;        var currentPage = 1</b>
<b class="nc">&nbsp;        val entries = mutableListOf&lt;HighscoresEntry&gt;()</b>
<b class="nc">&nbsp;        var fetchingTime = 0.0</b>
<b class="nc">&nbsp;        var parsingTime = 0.0</b>
<b class="nc">&nbsp;        var baseHighscores: Highscores? = null</b>
<b class="nc">&nbsp;        while (totalPages == 0 || currentPage &lt;= totalPages) {</b>
<b class="nc">&nbsp;            val response = fetchHighscoresPage(world, category, vocation, currentPage, battlEyeType, pvpTypes)</b>
<b class="nc">&nbsp;            if (response.data == null) return response</b>
<b class="nc">&nbsp;            entries.addAll(response.data.entries)</b>
<b class="nc">&nbsp;            totalPages = response.data.totalPages</b>
<b class="nc">&nbsp;            fetchingTime += response.fetchingTime</b>
<b class="nc">&nbsp;            parsingTime += response.parsingTime</b>
<b class="nc">&nbsp;            if (currentPage == 1) {</b>
<b class="nc">&nbsp;                baseHighscores = response.data</b>
&nbsp;            }
<b class="nc">&nbsp;            currentPage++</b>
&nbsp;        }
<b class="nc">&nbsp;        return TibiaResponse(</b>
<b class="nc">&nbsp;            timestamp = now,</b>
<b class="nc">&nbsp;            isCached = false,</b>
<b class="nc">&nbsp;            cacheAge = 0,</b>
<b class="nc">&nbsp;            fetchingTime = fetchingTime,</b>
<b class="nc">&nbsp;            parsingTime = parsingTime,</b>
<b class="nc">&nbsp;            data = baseHighscores!!.copy(entries = entries)</b>
&nbsp;        )
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Fetch the houses section for a [world] and [town].
&nbsp;     */
<b class="nc">&nbsp;    public open suspend fun fetchHousesSection(</b>
&nbsp;        world: String,
&nbsp;        town: String,
<b class="nc">&nbsp;        type: HouseType? = null,</b>
<b class="nc">&nbsp;        status: HouseStatus? = null,</b>
<b class="nc">&nbsp;        order: HouseOrder? = null,</b>
&nbsp;    ): TibiaResponse&lt;HousesSection?&gt; {
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getHousesSectionUrl(world, town, type, status, order))</b>
<b class="nc">&nbsp;        return response.parse { HousesSectionParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
&nbsp;    /** Fetch a house by its [houseId] in a specific world. */
<b class="nc">&nbsp;    public open suspend fun fetchHouse(</b>
&nbsp;        houseId: Int,
&nbsp;        world: String,
&nbsp;    ): TibiaResponse&lt;House?&gt; {
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getHouseUrl(world, houseId))</b>
<b class="nc">&nbsp;        return response.parse { HouseParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Fetches the Tibia Drome leaderboards for a [world].
&nbsp;     *
&nbsp;     * If the world does not exist, the leaderboards will be null.
&nbsp;     * @param rotation The rotation number to see. Tibia.com only allows viewing the current and last rotations. Any other value takes you to the current leaderboard.
&nbsp;     */
<b class="nc">&nbsp;    public open suspend fun fetchLeaderboards(</b>
&nbsp;        world: String,
<b class="nc">&nbsp;        rotation: Int? = null,</b>
<b class="nc">&nbsp;        page: Int = 1,</b>
&nbsp;    ): TibiaResponse&lt;Leaderboards?&gt; {
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getLeaderboardUrl(world, rotation, page))</b>
<b class="nc">&nbsp;        return response.parse { LeaderboardsParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
&nbsp;    // endregion
&nbsp;
&nbsp;    // region Forum Section
&nbsp;
&nbsp;    /**
&nbsp;     * Fetches a forum section by its internal [sectionId].
&nbsp;     */
<b class="nc">&nbsp;    public open suspend fun fetchForumSection(sectionId: Int): TibiaResponse&lt;ForumSection?&gt; {</b>
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getForumSectionUrl(sectionId))</b>
<b class="nc">&nbsp;        return response.parse { ForumSectionParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
&nbsp;    /** Fetches a specific forum section. */
<b class="nc">&nbsp;    public open suspend fun fetchForumSection(section: AvailableForumSection): TibiaResponse&lt;ForumSection?&gt; {</b>
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getForumSectionUrl(section))</b>
<b class="nc">&nbsp;        return response.parse { ForumSectionParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
&nbsp;    /** Fetches a board from the Tibia.com forum.
&nbsp;     *
&nbsp;     * @param threadAge The maximum age of displayed threads. A value of -1 means no limit. Null means the server limit will be used.
&nbsp;     */
<b class="nc">&nbsp;    public open suspend fun fetchForumBoard(</b>
&nbsp;        boardId: Int,
<b class="nc">&nbsp;        page: Int = 1,</b>
<b class="nc">&nbsp;        threadAge: Int? = null,</b>
&nbsp;    ): TibiaResponse&lt;ForumBoard?&gt; {
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getForumBoardUrl(boardId, page, threadAge))</b>
<b class="nc">&nbsp;        return response.parse { ForumBoardParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
&nbsp;    /** Fetches a thread from the Tibia.com forum. */
<b class="nc">&nbsp;    public open suspend fun fetchForumAnnouncement(announcementId: Int): TibiaResponse&lt;ForumAnnouncement?&gt; {</b>
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getForumAnnouncementUrl(announcementId))</b>
<b class="nc">&nbsp;        return response.parse { ForumAnnouncementParser.fromContent(it, announcementId) }</b>
&nbsp;    }
&nbsp;
&nbsp;    /** Fetches a forum thread from Tibia.com. */
<b class="nc">&nbsp;    public open suspend fun fetchForumThread(threadId: Int, page: Int = 1): TibiaResponse&lt;ForumThread?&gt; {</b>
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getForumThreadUrl(threadId, page))</b>
<b class="nc">&nbsp;        return response.parse { ForumThreadParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
&nbsp;    /** Fetches a forum thread containing the specified post.
&nbsp;     *
&nbsp;     * The thread will be fetched on the page containing the [ForumThread.anchoredPost]
&nbsp;     */
<b class="nc">&nbsp;    public open suspend fun fetchForumPost(postId: Int): TibiaResponse&lt;ForumThread?&gt; {</b>
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getForumPostUrl(postId))</b>
<b class="nc">&nbsp;        return response.parse {</b>
<b class="nc">&nbsp;            ForumThreadParser.fromContent(it)?.let { thread -&gt;</b>
<b class="nc">&nbsp;                thread.copy(anchoredPost = thread.entries.first { post -&gt; post.postId == postId })</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    /** Fetch CM posts between two dates. */
<b class="nc">&nbsp;    public open suspend fun fetchCMPostArchive(</b>
&nbsp;        startDate: LocalDate,
&nbsp;        endDate: LocalDate,
<b class="nc">&nbsp;        page: Int = 0,</b>
&nbsp;    ): TibiaResponse&lt;CMPostArchive&gt; {
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getCMPostArchiveUrl(startDate, endDate, page))</b>
<b class="nc">&nbsp;        return response.parse { CMPostArchiveParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
&nbsp;    /** Fetch CM posts from today to the last specified [days]. */
<b class="nc">&nbsp;    public open suspend fun fetchCMPostArchive(days: Int, page: Int = 0): TibiaResponse&lt;CMPostArchive&gt; =</b>
<b class="nc">&nbsp;        fetchCMPostArchive(LocalDate.now().minusDays(days.toLong()), LocalDate.now(), page)</b>
&nbsp;
&nbsp;    // endregion
&nbsp;
&nbsp;    // region Char Bazaar Section
&nbsp;    /**
&nbsp;     * Fetch the character bazaar.
&nbsp;     *
&nbsp;     * @param type Whether to show current auctions or the auction history.
&nbsp;     * @param filters The filtering parameters to use.
&nbsp;     * @param page The page to display.
&nbsp;     */
<b class="nc">&nbsp;    public open suspend fun fetchBazaar(</b>
<b class="nc">&nbsp;        type: BazaarType = BazaarType.CURRENT,</b>
<b class="nc">&nbsp;        filters: BazaarFilters? = null,</b>
<b class="nc">&nbsp;        page: Int = 1,</b>
&nbsp;    ): TibiaResponse&lt;CharacterBazaar&gt; {
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getBazaarUrl(type, filters, page))</b>
<b class="nc">&nbsp;        return response.parse { CharacterBazaarParser.fromContent(it) }</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Fetch the character bazaar from Tibia.com.
&nbsp;     */
<b class="nc">&nbsp;    public open suspend fun fetchBazaar(</b>
<b class="nc">&nbsp;        type: BazaarType = BazaarType.CURRENT,</b>
<b class="nc">&nbsp;        page: Int = 1,</b>
<b class="nc">&nbsp;        filterBuilder: (BazaarFiltersBuilder.() -&gt; Unit)? = null,</b>
&nbsp;    ): TibiaResponse&lt;CharacterBazaar&gt; =
<b class="nc">&nbsp;        fetchBazaar(type, filterBuilder?.let { BazaarFiltersBuilder().apply(it).build() }, page)</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Fetch an auction from Tibia.com.
&nbsp;     *
&nbsp;     * @param auctionId The ID of the auction to fetch.
&nbsp;     * @param skipDetails Whether to only fetch the auction&#39;s header and skip details.
&nbsp;     * @param fetchItems Whether to fetch items from further pages if necessary. Cannot be done if [skipDetails] is true.
&nbsp;     * @param fetchOutfits Whether to fetch outfits from further pages if necessary. Cannot be done if [skipDetails] is true.
&nbsp;     * @param fetchMounts Whether to fetch mounts from further pages if necessary. Cannot be done if [skipDetails] is true.
&nbsp;     */
<b class="nc">&nbsp;    public open suspend fun fetchAuction(</b>
&nbsp;        auctionId: Int,
<b class="nc">&nbsp;        skipDetails: Boolean = false,</b>
<b class="nc">&nbsp;        fetchItems: Boolean = false,</b>
<b class="nc">&nbsp;        fetchOutfits: Boolean = false,</b>
<b class="nc">&nbsp;        fetchMounts: Boolean = false,</b>
&nbsp;    ): TibiaResponse&lt;Auction?&gt; {
<b class="nc">&nbsp;        val response = this.request(HttpMethod.Get, getAuctionUrl(auctionId))</b>
<b class="nc">&nbsp;        val tibiaResponse = response.parse { AuctionParser.fromContent(it, auctionId, !skipDetails) }</b>
<b class="nc">&nbsp;        return if (tibiaResponse.data?.details != null &amp;&amp; (fetchItems || fetchMounts || fetchOutfits)) {</b>
<b class="nc">&nbsp;            fetchAuctionAdditionalPages(tibiaResponse, fetchItems, fetchMounts, fetchOutfits)</b>
&nbsp;        } else {
<b class="nc">&nbsp;            tibiaResponse</b>
&nbsp;        }
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    private suspend fun fetchAuctionAdditionalPages(</b>
&nbsp;        tibiaResponse: TibiaResponse&lt;Auction?&gt;,
<b class="nc">&nbsp;        fetchItems: Boolean = false,</b>
<b class="nc">&nbsp;        fetchOutfits: Boolean = false,</b>
<b class="nc">&nbsp;        fetchMounts: Boolean = false,</b>
&nbsp;    ): TibiaResponse&lt;Auction?&gt; {
<b class="nc">&nbsp;        if (tibiaResponse.data?.details == null) return tibiaResponse</b>
<b class="nc">&nbsp;        val accumulator = Timing(tibiaResponse.fetchingTime, tibiaResponse.parsingTime)</b>
<b class="nc">&nbsp;        var itemEntries: List&lt;ItemEntry&gt;? = null</b>
<b class="nc">&nbsp;        var storeItemEntries: List&lt;ItemEntry&gt;? = null</b>
<b class="nc">&nbsp;        var outfitEntries: List&lt;OutfitEntry&gt;? = null</b>
<b class="nc">&nbsp;        var storeOutfitEntries: List&lt;OutfitEntry&gt;? = null</b>
<b class="nc">&nbsp;        var mountEntries: List&lt;MountEntry&gt;? = null</b>
<b class="nc">&nbsp;        var storeMountEntries: List&lt;MountEntry&gt;? = null</b>
<b class="nc">&nbsp;        if (fetchItems) {</b>
<b class="nc">&nbsp;            itemEntries = fetchAllPages(</b>
<b class="nc">&nbsp;                tibiaResponse.data.auctionId, AuctionPagesType.ITEMS, tibiaResponse.data.details!!.items</b>
<b class="nc">&nbsp;            ).accumulateTime(accumulator)</b>
<b class="nc">&nbsp;            storeItemEntries = fetchAllPages(</b>
<b class="nc">&nbsp;                tibiaResponse.data.auctionId, AuctionPagesType.ITEMS_STORE, tibiaResponse.data.details!!.storeItems</b>
<b class="nc">&nbsp;            ).accumulateTime(accumulator)</b>
&nbsp;        }
<b class="nc">&nbsp;        if (fetchMounts) {</b>
<b class="nc">&nbsp;            mountEntries = fetchAllPages(</b>
<b class="nc">&nbsp;                tibiaResponse.data.auctionId, AuctionPagesType.MOUNTS, tibiaResponse.data.details!!.mounts</b>
<b class="nc">&nbsp;            ).accumulateTime(accumulator)</b>
<b class="nc">&nbsp;            storeMountEntries = fetchAllPages(</b>
<b class="nc">&nbsp;                tibiaResponse.data.auctionId, AuctionPagesType.MOUNTS_STORE, tibiaResponse.data.details!!.storeMounts</b>
<b class="nc">&nbsp;            ).accumulateTime(accumulator)</b>
&nbsp;        }
<b class="nc">&nbsp;        if (fetchOutfits) {</b>
<b class="nc">&nbsp;            outfitEntries = fetchAllPages(</b>
<b class="nc">&nbsp;                tibiaResponse.data.auctionId, AuctionPagesType.OUTFITS, tibiaResponse.data.details!!.outfits</b>
<b class="nc">&nbsp;            ).accumulateTime(accumulator)</b>
<b class="nc">&nbsp;            storeOutfitEntries = fetchAllPages(</b>
<b class="nc">&nbsp;                tibiaResponse.data.auctionId, AuctionPagesType.OUTFITS_STORE, tibiaResponse.data.details!!.storeOutfits</b>
<b class="nc">&nbsp;            ).accumulateTime(accumulator)</b>
&nbsp;        }
<b class="nc">&nbsp;        return tibiaResponse.copy(</b>
<b class="nc">&nbsp;            fetchingTime = accumulator.fetching, parsingTime = accumulator.parsing, data = tibiaResponse.data.copy(</b>
<b class="nc">&nbsp;                details = tibiaResponse.data.details!!.copy(</b>
<b class="nc">&nbsp;                    items = tibiaResponse.data.details!!.items.copy(</b>
<b class="nc">&nbsp;                        entries = itemEntries ?: tibiaResponse.data.details!!.items.entries,</b>
<b class="nc">&nbsp;                        isFullyFetched = fetchItems,</b>
&nbsp;                    ),
<b class="nc">&nbsp;                    storeItems = tibiaResponse.data.details!!.items.copy(</b>
<b class="nc">&nbsp;                        entries = storeItemEntries ?: tibiaResponse.data.details!!.items.entries,</b>
<b class="nc">&nbsp;                        isFullyFetched = fetchItems,</b>
&nbsp;                    ),
<b class="nc">&nbsp;                    mounts = tibiaResponse.data.details!!.mounts.copy(</b>
<b class="nc">&nbsp;                        entries = mountEntries ?: tibiaResponse.data.details!!.mounts.entries,</b>
<b class="nc">&nbsp;                        isFullyFetched = fetchMounts,</b>
&nbsp;                    ),
<b class="nc">&nbsp;                    storeMounts = tibiaResponse.data.details!!.storeMounts.copy(</b>
<b class="nc">&nbsp;                        entries = storeMountEntries ?: tibiaResponse.data.details!!.storeMounts.entries,</b>
<b class="nc">&nbsp;                        isFullyFetched = fetchMounts</b>
&nbsp;                    ),
<b class="nc">&nbsp;                    outfits = tibiaResponse.data.details!!.outfits.copy(</b>
<b class="nc">&nbsp;                        entries = outfitEntries ?: tibiaResponse.data.details!!.outfits.entries,</b>
<b class="nc">&nbsp;                        isFullyFetched = fetchOutfits,</b>
&nbsp;                    ),
<b class="nc">&nbsp;                    storeOutfits = tibiaResponse.data.details!!.storeOutfits.copy(</b>
<b class="nc">&nbsp;                        entries = storeOutfitEntries ?: tibiaResponse.data.details!!.storeOutfits.entries,</b>
<b class="nc">&nbsp;                        isFullyFetched = fetchOutfits,</b>
&nbsp;                    ),
&nbsp;                )
&nbsp;            )
&nbsp;        )
&nbsp;    }
&nbsp;
&nbsp;    // endregion
&nbsp;
&nbsp;
&nbsp;    /** Convert to a [TibiaResponse]. */
<b class="nc">&nbsp;    private fun &lt;T&gt; HttpResponse.toTibiaResponse(parsingTime: Double, data: T): TibiaResponse&lt;T&gt; = TibiaResponse(</b>
<b class="nc">&nbsp;        timestamp = Instant.fromEpochMilliseconds(responseTime.timestamp),</b>
<b class="nc">&nbsp;        isCached = headers[&quot;CF-Cache-Status&quot;] == &quot;HIT&quot;,</b>
<b class="nc">&nbsp;        cacheAge = headers[&quot;Age&quot;]?.toInt() ?: 0,</b>
<b class="nc">&nbsp;        fetchingTime = fetchingTime,</b>
<b class="nc">&nbsp;        parsingTime = parsingTime,</b>
<b class="nc">&nbsp;        data = data</b>
&nbsp;    )
&nbsp;
&nbsp;    /**
&nbsp;     * Parse the [HttpResponse] into a TibiaResponse.
&nbsp;     */
<b class="nc">&nbsp;    private suspend fun &lt;T&gt; HttpResponse.parse(parser: (content: String) -&gt; T): TibiaResponse&lt;T&gt; {</b>
<b class="nc">&nbsp;        val data: T</b>
<b class="nc">&nbsp;        val parsingTime = measureTimeMillis {</b>
<b class="nc">&nbsp;            val stringBody: String = body()</b>
<b class="nc">&nbsp;            data = parser(stringBody)</b>
<b class="nc">&nbsp;        } / 1000.0</b>
<b class="nc">&nbsp;        logger.info { &quot;${this.request.url} | PARSE | ${(parsingTime * 1000).toInt()}ms&quot; }</b>
<b class="nc">&nbsp;        return toTibiaResponse(parsingTime, data)</b>
&nbsp;    }
&nbsp;
&nbsp;    @Suppress(&quot;MaxLineLength&quot;)
&nbsp;    /**
&nbsp;     * Get the URL to the endpoint to get page items for auctions.
&nbsp;     */
&nbsp;    private fun getAuctionAjaxPaginationUrl(auctionId: Int, type: AuctionPagesType, page: Int): String =
<b class="nc">&nbsp;        &quot;https://www.tibia.com/websiteservices/handle_charactertrades.php?auctionid=$auctionId&amp;type=${type.typeId}&amp;currentpage=$page&quot;</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Fetch a single page from the auction pagination endpoint.
&nbsp;     */
<b class="nc">&nbsp;    private suspend fun fetchAjaxPage(auctionId: Int, type: AuctionPagesType, page: Int): TimedResult&lt;AjaxResponse&gt; {</b>
<b class="nc">&nbsp;        val response = this.request(</b>
<b class="nc">&nbsp;            HttpMethod.Get, getAuctionAjaxPaginationUrl(auctionId, type, page),</b>
<b class="nc">&nbsp;            headers = listOf(&quot;x-requested-with&quot; to &quot;XMLHttpRequest&quot;),</b>
&nbsp;        )
<b class="nc">&nbsp;        return TimedResult(response.fetchingTime, Json.decodeFromString(AjaxResponse.serializer(), response.body()))</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Fetch all the pages, parse and collect the entries.
&nbsp;     * @param auctionId The id of the auction.
&nbsp;     * @param type The type of items.
&nbsp;     * @param paginator The paginator class that holds the collection
&nbsp;     */
&nbsp;    private suspend inline fun &lt;reified E, T : AjaxPaginator&lt;E&gt;&gt; fetchAllPages(
&nbsp;        auctionId: Int,
&nbsp;        type: AuctionPagesType,
&nbsp;        paginator: T,
&nbsp;    ): Pair&lt;Timing, List&lt;E&gt;&gt; {
<b class="nc">&nbsp;        var currentPage = paginator.currentPage + 1</b>
<b class="nc">&nbsp;        val entries: MutableList&lt;E&gt; = paginator.entries.toMutableList()</b>
<b class="nc">&nbsp;        val timing = Timing()</b>
<b class="nc">&nbsp;        while (currentPage &lt;= paginator.totalPages) {</b>
<b class="nc">&nbsp;            val (fetchingTime, ajaxResponse) = fetchAjaxPage(auctionId, type, currentPage)</b>
<b class="nc">&nbsp;            timing.fetching += fetchingTime</b>
<b class="nc">&nbsp;            val parsingTime = measureTimeMillis {</b>
<b class="nc">&nbsp;                entries.addAll(AuctionParser.parsePageItems(ajaxResponse.ajaxObjects.first().data))</b>
<b class="nc">&nbsp;            } / 1000.0</b>
<b class="nc">&nbsp;            timing.parsing += parsingTime</b>
<b class="nc">&nbsp;            logger.info {</b>
<b class="nc">&nbsp;                &quot;${</b>
<b class="nc">&nbsp;                    getAuctionAjaxPaginationUrl(auctionId, type, currentPage)</b>
<b class="nc">&nbsp;                } | PARSE | ${(parsingTime * 1000).toInt()}ms&quot;</b>
&nbsp;            }
<b class="nc">&nbsp;            currentPage++</b>
&nbsp;        }
<b class="nc">&nbsp;        return timing to entries</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * A data class to hold fetching and parsing times.
&nbsp;     */
<b class="nc">&nbsp;    private data class Timing(var fetching: Double = 0.0, var parsing: Double = 0.0)</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Extract the results of [fetchAllPages] and sum the timings into the [accumulator].
&nbsp;     */
&nbsp;    private fun &lt;T&gt; Pair&lt;Timing, List&lt;T&gt;&gt;.accumulateTime(accumulator: Timing): List&lt;T&gt; {
<b class="nc">&nbsp;        accumulator.fetching += first.fetching</b>
<b class="nc">&nbsp;        accumulator.parsing += first.parsing</b>
<b class="nc">&nbsp;        return second</b>
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    private data class TimedResult&lt;T&gt;(val time: Double, val result: T)</b>
&nbsp;
&nbsp;    internal companion object {
<b class="pc">&nbsp;        internal val logger = KotlinLogging.logger { }</b>
&nbsp;
<b class="nc">&nbsp;        private val HttpResponse.fetchingTime get() = (responseTime.timestamp - requestTime.timestamp) / 1000.0</b>
<b class="nc">&nbsp;        private val HttpResponse.fetchingTimeMillis get() = (fetchingTime * 1000).toInt()</b>
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-03-15 02:46</div>
</div>
</body>
</html>
